(function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)})({1:function(e,t,n){e.exports=n("ecd1")},"76f4":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));const o={GET_COOKIE:"IG_DM_GET_COOKIE",MONITOR_NEW_FOLLOWER_OR_LIKE:"MONITOR_NEW_FOLLOWER_OR_LIKE",START_MONITOR_NEW_FOLLOWER_OR_LIKE:"START_MONITOR_NEW_FOLLOWER_OR_LIKE",STOP_POLLING_MONITOR_SCHEDULE:"STOP_POLLING_MONITOR_SCHEDULE",STOP_DM:"STOP_DM",NEXT_DM:"NEXT_DM"};function r(e="",t={},n){chrome.runtime.sendMessage({type:e,data:t},n)}},"90b9":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const o="https://www.instagram.com/direct/inbox/?ig_dm";function r(e=""){return e.startsWith(o)}},ca8f:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return O})),n.d(t,"g",(function(){return _})),n.d(t,"c",(function(){return f}));const o={AutoReplySetting:"autoReplySetting",MONITOR_INBOX_POOL:"monitor_inbox_pool",DM_USER_HISTORY_POOL:"dm_user_history_pool",IG_HEADER:"ig_header"};async function r(e={}){return new Promise((t,n)=>{try{chrome.storage.local.set(e,(function(){t()}))}catch(o){console.error("error: ",o),n(o)}})}async function c(e=""){return new Promise((t,n)=>{try{chrome.storage.local.get([e],(function(n){t(n[e])}))}catch(o){console.error("error: ",o),n(o)}})}async function a(e={}){try{const t=await c(o.AutoReplySetting)||{};Object.assign(t,e),await r({[o.AutoReplySetting]:t})}catch(t){console.error("error: ",t)}}async function i(){try{const e=await c(o.AutoReplySetting)||{};return e}catch(e){console.error("error: ",e)}}async function s(e=[]){try{await r({[o.MONITOR_INBOX_POOL]:[...e]})}catch(t){console.error("error: ",t)}}async function u(){try{const e=await c(o.MONITOR_INBOX_POOL)||[];return e}catch(e){console.error("error: ",e)}}async function l(e=[]){try{await r({[o.DM_USER_HISTORY_POOL]:[...e]})}catch(t){console.error("error: ",t)}}async function O(){try{const e=await c(o.DM_USER_HISTORY_POOL)||[];return e}catch(e){console.error("error: ",e)}}async function _(e={}){try{await r({[o.IG_HEADER]:e})}catch(t){console.error("error: ",t)}}async function f(){try{const e=await c(o.IG_HEADER)||{};return e}catch(e){console.error("error: ",e)}}},ecd1:function(e,t,n){"use strict";n.r(t);var o=n("ca8f"),r=n("76f4"),c=n("90b9"),a=n("f121");function i(e,t,n){chrome.cookies.get({url:e,name:t},(function(e){n&&void 0!=e&&n(e.value)}))}async function s(){return new Promise(e=>{chrome.tabs.query({currentWindow:!0},t=>{console.log(t);for(let o=0;o<t.length;o++){var n;const r=t[o];if(console.log(r),null!==(n=r.url)&&void 0!==n&&n.includes(chrome.runtime.id))return void e(r)}e(null)})})}const u={POLLING_MONITOR_SCHEDULE:"POLLING_MONITOR_SCHEDULE",NEXT_DM_SCHEDULE:"NEXT_DM_SCHEDULE"};let l=null,O=null,_=null;function f(e){O=chrome.tabs.connect(e,{name:"iframe_connect"}),console.log("%c bg: connect content.","color:#0f0;"),O.onMessage.addListener((function(e){const{type:t,data:n}=e||{};t===r["a"].GET_COOKIE&&i(n.url,n.name,e=>{O.postMessage({type:r["a"].GET_COOKIE,data:{value:e}})})})),O.onDisconnect.addListener(()=>{console.log("Disconnected: stop monitor."),d()})}async function m(){clearTimeout(_),_=setTimeout(async()=>{console.log("%c start monitor.","color:#0f0;"),await Object(o["h"])([]),chrome.alarms.create(u.POLLING_MONITOR_SCHEDULE,{periodInMinutes:a["a"].POLLING_MONITOR_INTERVAL})},6e3)}function d(){var e;console.log("%c stop monitor.","color:#ff1515;"),clearTimeout(_),null===(e=O)||void 0===e||e.postMessage({type:r["a"].STOP_DM}),chrome.alarms.clear(u.POLLING_MONITOR_SCHEDULE),setTimeout(()=>{O=null,l=null})}function E(){chrome.alarms.clearAll()}chrome.alarms.onAlarm.addListener((function(e){if(e.name===u.POLLING_MONITOR_SCHEDULE){if(!O||!l)return;O.postMessage({type:r["a"].MONITOR_NEW_FOLLOWER_OR_LIKE})}e.name===u.NEXT_DM_SCHEDULE&&l.postMessage({type:r["a"].NEXT_DM})})),chrome.runtime.onMessage.addListener((function(e,t,n){Object(c["a"])(null===t||void 0===t?void 0:t.url)&&(l=t.tab.id,f(l));const{type:o=""}=e||{};o===r["a"].START_MONITOR_NEW_FOLLOWER_OR_LIKE&&(m(),n(1)),o===r["a"].STOP_POLLING_MONITOR_SCHEDULE&&d()}));const L=["http://*.instagram.com/*","https://*.instagram.com/*","https://*.facebook.com/*","http://*.doubleclick.net/*"];async function p(){for(const e of L){const t=(await chrome.cookies.getAll({url:e})).filter(e=>"unspecified"===e.sameSite);await Promise.all(t.map(async t=>{e.startsWith("http://")?await chrome.cookies.remove({url:e,name:t.name}):await chrome.cookies.set({url:e,name:t.name,value:t.value,domain:t.domain,path:t.path,secure:!0,httpOnly:t.httpOnly,sameSite:"no_restriction",expirationDate:t.expirationDate,storeId:t.storeId})}))}}async function h(){let e=chrome.runtime.getManifest();return e.version}async function y(){await p(),setTimeout(()=>{chrome.tabs.create({url:"./app.html"},()=>{d()})})}console.log("hi from background."),chrome.runtime.onInstalled.addListener(async e=>{"install"===e.reason&&(await p(),chrome.runtime.openOptionsPage()),E()}),chrome.runtime.onStartup.addListener(E),setTimeout((async function(){let e=await h();chrome.runtime.setUninstallURL("https://linkedradar.com/feedback-form/ig-dm-feedback?version="+e)}),500),chrome.action.onClicked.addListener(async()=>{const e=await s();if(e){const t=e.id;chrome.tabs.update(t,{active:!0,highlighted:!0})}else y()}),chrome.webRequest.onHeadersReceived.addListener(async e=>{const{responseHeaders:t}=e,n=await Object(o["c"])();for(const r of t)if("x-ig-set-www-claim"===r.name){n[r.name]=r.value,Object(o["g"])(n);break}},{urls:["https://*.instagram.com/*"]},["responseHeaders"])},f121:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o={POLLING_MONITOR_INTERVAL:1,DELAY_BETWEEN_DM:{MIN:18e4,MAX:36e4}}}});